---
title: "Conceptual Model Coverage in School Meal Literature"
output:
  html_document:
    toc: true
    toc_depth: 2
bibliography: bib/HUPH_Kim Anh.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(bibtex)
library(stringr)
library(dplyr)
```

## Conceptual Model Overview

Below is the simplified conceptual model guiding this synthesis.

![Conceptual Model](figures/Framework.png)

## Search Scope and Methodology

The original search query was:

> ("school nutrition" OR "school meal") AND (policy OR implementation OR intervention) AND ("primary school" OR "elementary school")

This query was used to identify papers relevant to the domains shown in the conceptual model above. We shared all the results and our annotations to a .bib file. 

```{r load-bib, warning=FALSE}
bib <- read.bib("bib/HUPH_Kim Anh.bib")
bib_texts <- sapply(bib, function(x) paste(x$title, x$abstract, x$annote, collapse = " "))
```

To assess alignment of each component of the model with literature evidence, we conducted keyword-based searches within a BibTeX file containing `r length(bib_texts)` sources.

## Coverage of Model Components

We explored the following components using targeted sub-queries.

### 1. Canteen Change

`canteen, cafeteria` Common institutional meal locations
`meal service, meal program, etc.`	Covers provision models
`school meal, school lunch, school food`	Typical descriptors
`school feeding`	Often used in development contexts
`food environment`	Broader contextual term
`on-campus consumption`	Links to food access location
`meal access`	Policy/accessibility framing
`school dining`	Used in some UK/European contexts

```{r canteen-change}
canteen_hits <- str_detect(
  tolower(bib_texts),
  "canteen|cafeteria|meal (service|program|provision|distribution)|school (meal|lunch|food|feeding)|food environment|on-campus consumption|meal access|school dining"
)
sum(canteen_hits)
canteen_refs <- names(bib)[canteen_hits]
canteen_citations <- paste0("@", canteen_refs, collapse = "; ")
```

These `r sum(canteen_hits)` studies address school food infrastructure and provision: `r canteen_citations`.

### 2. Nutrition Lessons

`nutrition education, health class, health curriculum`	Core curriculum elements
`food literacy, nutrition literacy, food knowledge, nutrition knowledge`	Common in policy and public health
`dietary education, nutrition behavior change, nutrition awareness`	Used in behavioral studies
`school garden, cooking class, hands-on food education`	Experiential nutrition learning
`meal planning skills, food skills`	Often addressed in interventions
nutrition training for students	Captures programs outside formal classroom time

```{r nutrition-lessons}
nutrition_hits <- str_detect(
  tolower(bib_texts),
  "nutrition education|health (class|curriculum|lesson|teaching)|food literacy|nutrition literacy|dietary education|healthy eating class|nutrition knowledge|food knowledge|food skills|school garden|hands-on food education|meal planning skills|cooking class|cooking program|nutrition training for students|nutrition behavior change|nutrition awareness"
)
sum(nutrition_hits)
nutrition_refs <- names(bib)[nutrition_hits]
nutrition_citations <- paste0("@", nutrition_refs, collapse = "; ")
```

These `r sum(nutrition_hits)` studies address the nutritional effects of school meals: `r nutrition_citations`.


### 3. Intervention Affordability

Since we're focusing specifically on intervention affordability for the school (not for families or students), here's a carefully expanded search string that captures financial feasibility, cost concerns, budgeting, and funding sources from the school or institutional perspective.

`cost(s)?, budget, finance, funding`	Core financial terms
`financial burden, constraint, pressure`	Phrases common in implementation studies
`resource limitation, economic feasibility, sustainability`	Structural cost themes
`school expenses, program cost, operational cost, underfunded`	Focus on school or program perspective
`cost-effectiveness`	Often used in evaluation and decision frameworks

```{r affordability}
affordability_hits <- str_detect(
  tolower(bib_texts),
  "cost(s)?|affordability|budget(ing)?|finance|financial (barrier|burden|constraint|pressure)|funding|implementation cost|resource limitation|school (expenses|spending|budget|outlay)|program cost|economic feasibility|lack of funds|operational cost|sustainability|cost-effectiveness|underfunded"
)
sum(affordability_hits)
affordability_refs <- names(bib)[affordability_hits]
affordability_citations <- paste0("@", affordability_refs, collapse = "; ")
```

These `r sum(affordability_hits)` studies the affordability of school meal interventions: `r affordability_citations`.

### 4. Staff Skill and Knowledge

`staff training, staff development, capacity, competence`	Core concepts
`teacher training, preparedness, awareness`	Links to delivery of education/nutrition lessons
`nutrition staff/personnel, kitchen staff, canteen workers, catering staff`	Broad inclusion of food service personnel
`food handler, cook, chef`	Specific job roles in food provision
`human resource`	Generic but relevant for systems-level descriptions
implementation capacity	Used in evaluations and program design literature

```{r staff-skills}
staff_hits <- str_detect(
  tolower(bib_texts),
  "staff (training|capacity|competence|skill|development|support)|teacher (knowledge|training|awareness|preparedness|capacity)|nutrition (staff|personnel)|kitchen (staff|workers)|canteen (staff|workers)|school (food handler|cook|chef|catering staff)|human resource|implementation capacity"
)
sum(staff_hits)
staff_refs <- names(bib)[staff_hits]
staff_citations <- paste0("@", staff_refs, collapse = "; ")
```

These `r sum(staff_hits)` studies address staff time and capacity in schools as they related to school meal interventions: `r staff_citations`.

### 5. Off-Campus Consumption

`street food, external vendors`	Common in low/middle-income contexts
`off-campus consumption/eating/purchasing`	Core concept
`nearby shops, food outlets`	Environment-level terms
`snacking outside school, eating elsewhere`	Behavioral framing
`home-packed meals, food brought from home`	Domestic sourcing
`canteen avoidance, non-school food, outside food`	Competitor framing for school meals

`lunch box, packed lunch, eating outside, snack purchases, other food sources` general terms

<!-- debug with which(str_detect(tolower(bib_texts), "lunch box|packed lunch")) -->

```{r off-campus}
offcampus_hits <- str_detect(
  tolower(bib_texts),
  "street\\s?food|off[-\\s]?campus (eating|consumption|buying|purchase|sales)|external (food|vendor|consumption)|outside (food|vendors|snacks)|nearby (shops|markets|stores|snacks)|snack (vendors|purchases)|brought from home|home[-\\s]?packed (meal|lunch|snack)|packed lunch|home food|food (from|prepared) at home|lunch box|canteen (avoid|skip)|not using school meal|other food sources|eating outside|food sold around school"
)

sum(offcampus_hits)

offcampus_refs <- names(bib)[offcampus_hits]
offcampus_citations <- paste0("@", offcampus_refs, collapse = "; ")
```

These `r sum(offcampus_hits)` studies address off-camous food and the effect on school meal interventions: `r offcampus_citations`.


### 6. Student Health

`student health, school health, child health`	General terms for school-age wellbeing
`bmi, body mass index, malnutrition, overweight, obesity`	Standard anthropometric indicators
`undernutrition, stunting, wasting`	Low- and Middle-Income Countries (LMIC-specific) nutrition indicators
`micronutrient deficiency, iron deficiency, anemia`	Specific health effects of poor diets
`nutrition outcome, growth outcomes, health effects`	Broader evaluation terms
`diet quality, healthy eating`	Dietary-behavior-related proxies
`public health`	To catch broader systemic framing

```{r student-health}
health_hits <- str_detect(
  tolower(bib_texts),
  "student health|child health|children's health|school health|nutritional status|nutrition outcome|nutrition impact|body mass index|bmi|malnutrition|undernutrition|stunting|wasting|micronutrient deficiency|iron deficiency|anemia|overweight|obesity|healthy eating|health effects|diet quality|growth outcomes|public health"
)

sum(health_hits)

health_refs <- names(bib)[health_hits]
health_citations <- paste0("@", health_refs, collapse = "; ")
```

These `r sum(health_hits)` studies address the health effects of school meal interventions: `r health_citations`.

### 7. Student Learning

`cognitive development, function, skills`	Core brain-based effects
`academic performance, achievement, school performance`	Common outcome measures
`attention span, concentration, mental focus, memory`	Mechanisms behind learning gains
`school attendance, absenteeism, dropout`	Frequently measured proxies in program evaluations
`test scores, learning capacity, study habits`	Quantitative and behavioral indicators
`student engagement, classroom behavior`	Intermediate effects tied to attention and participation

```{r student-learning}
learning_hits <- str_detect(
  tolower(bib_texts),
  "cognitive (development|function|skills)|learning outcomes|academic performance|academic achievement|school performance|educational outcomes|attention span|concentration|memory|school readiness|classroom behavior|absenteeism|school attendance|dropout|test scores|learning capacity|mental focus|study habits|student engagement"
)

sum(learning_hits)

learning_refs <- names(bib)[learning_hits]
learning_citations <- paste0("@", learning_refs, collapse = "; ")
```

These `r sum(learning_hits)` studies address the learning effect on nutrition outcomes: `r learning_citations`.

## Summary Table

```{r summary-table}
summary_df <- data.frame(
  Component = c("Canteen Change", "Nutrition Lessons", "Affordability", "Staff Skills", 
                "Off-Campus Consumption", "Student Health", "Student Learning"),
  Hits = c(sum(canteen_hits), sum(nutrition_hits), sum(affordability_hits),
           sum(staff_hits), sum(offcampus_hits), sum(health_hits), sum(learning_hits))
)
summary_df
```

This summary quantifies the degree of support each component has in the reviewed literature.

# References